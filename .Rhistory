tree <- ape::read.tree(file.choose())
tree <- ape::read.nexus(file.choose())
tree
phy =
tree
tree
library(ape)
extract.clade(tree, node = 600)
phy <- extract.clade(tree, node = 600)
f=1
turnover=c(1,2)
eps=c(1,2)
fixed.eps=NULL
condition.on.survival=TRUE
root.type="madfitz"
root.p=NULL
sann=TRUE
sann.its=1000
bounded.search=TRUE
max.tol=.Machine$double.eps^.50
starting.vals=NULL
turnover.upper=10000
eps.upper=3
trans.upper=100
restart.obj=NULL
ode.eps=0
dt.threads=1
expand.mode=FALSE
misse_start_time <- Sys.time()
fixed.eps
length(fixed.eps)>0
is.na(fixed.eps)
expand.mode
######################################################################################################################################
######################################################################################################################################
### MiSSE -- Examines shifts in diversification in relation to hidden states ONLY
######################################################################################################################################
######################################################################################################################################
?MiSSE
######################################################################################################################################
######################################################################################################################################
### MiSSE -- Examines shifts in diversification in relation to hidden states ONLY
######################################################################################################################################
######################################################################################################################################
library(hisse)
?MiSSE
?MiSSEgreedy
?MiSSEGreedy
tree <- read.nexus(file.choose())
tree
setwd("~/Desktop/mountains_of_easternSA")
plot(tree)
tree <- ladderize(read.nexus(file.choose()))
write.tree(tree, file="gesneriaceae.txt")
tree <- ladderize(read.nexus(file.choose()))
plot(tree)
write.tree(tree, file="velloziaceae.txt")
tree <- ladderize(read.nexus(file.choose()))
tree <- ladderize(read.tree(file.choose()))
plot(tree)
write.tree(tree, file="begonia.txt")
tree <- ladderize(read.tree(file.choose()))
plot(tree)
write.tree(tree, file="vriesinae.txt")
tree <- ladderize(read.tree(file.choose()))
plot(tree)
tree$tip.label
write.csv(tree$tip.label, "vrieseinae.csv")
tree <- ladderize(read.tree(file.choose()))
tree$tip.label
write.csv(tree$tip.label, "begonia.csv")
tree <- ladderize(read.tree(file.choose()))
tree$tip.label
write.csv(tree$tip.label, "velloziaceae.csv")
tree <- ladderize(read.tree(file.choose()))
tree$tip.label
write.csv(tree$tip.label, "gesneriaceae.csv")
## Data in a data.frame
x1 <- rnorm(n=1E3, sd=2)
x2 <- x1*1.2 + rnorm(n=1E3, sd=2)
df <- data.frame(x1,x2)
## Use densCols() output to get density at each point
x <- densCols(x1,x2, colramp=colorRampPalette(c("black", "white")))
df$dens <- col2rgb(x)[1,] + 1L
## Map densities to colors
cols <-  colorRampPalette(c("#000099", "#00FEFF", "#45FE4F",
"#FCFF00", "#FF9400", "#FF3100"))(256)
df$col <- cols[df$dens]
## Plot it, reordering rows so that densest points are plotted on top
plot(x2~x1, data=df[order(df$dens),], pch=20, col=col, cex=2)
x1
x
df
## Data in a data.frame
x1 <- rnorm(n=1E3, sd=2)
x2 <- x1*1.2 + rnorm(n=1E3, sd=2)
x2
###
# to recover cleaned points back:
points.dir <- "~/Desktop/climate_niche_seed_dispersal/GBIF_points"
cleaned_point_files <- list.files(points.dir, ".csv")
cleaned_point_files <- cleaned_point_files[grepl("cleaned", cleaned_point_files)]
cleaned_points <- lapply(paste0(points.dir, "/", cleaned_point_files), fread)
library(data.table)
cleaned_points <- lapply(paste0(points.dir, "/", cleaned_point_files), fread)
# to recover cleaned points back:
climate_data.dir <- "~/Desktop/climate_niche_seed_dispersal/seed_dispersal/climatic_data"
climate_data.dir
summstats_files <- list.files(points.dir, "summstats.csv")
summstats_files
summstats_files <- list.files(climate_data.dir, "summstats.csv")
summstats_files
tree <- read.tree(file.choose())
tree
plot(tree)
summstats_files
summstats_files
summstats <- lapply(paste0(climate_data.dir, "/", summstats_files), fread)
summstats
summstats <- lapply(paste0(climate_data.dir, "/", summstats_files), read.csv)
View(summstats)
summstats[[1]]
summstats_files
names(summstats) <- unlist(lapply(strsplit(summstats_files, "_"), "[[", 1))
summstats
names(summstats)
setwd("~/Desktop/climate_niche_seed_dispersal/seed_dispersal/")
tree.dir <- paste0("~/Desktop/climate_niche_seed_dispersal/seed_dispersal/trees")
trait.dir <- paste0(getwd(), "~/Desktop/climate_niche_seed_dispersal/seed_dispersal/trait_data")
tree.dir <- paste0("~/Desktop/climate_niche_seed_dispersal/seed_dispersal/trees")
trait.dir <- "~/Desktop/climate_niche_seed_dispersal/seed_dispersal/trait_data"
tree.dir <- "~/Desktop/climate_niche_seed_dispersal/seed_dispersal/trees"
# Trees
tree_files <- list.files(tree.dir, ".tre")
trees <- lapply(paste0(tree.dir, "/", tree_files), read.tree)
trees <- lapply(trees, ladderize)
labels <- unlist(lapply(strsplit(tree_files, "_"), "[[", 1))
# Trait data
trait_files <- list.files(trait.dir, ".csv")
traits <- lapply(paste0(trait.dir, "/", trait_files), read.csv)
labels <- unlist(lapply(strsplit(trait_files, "_"), "[[", 1))
names(traits) <- labels
trait.dir
traits
group_index=1
names(traits)
group <- names(traits)[group_index]
group_traits <- traits[[group]][,1:2]
group
group_traits
group_tree <- trees[[grep(group, names(trees))]]
group_summstats <- summstats[[grep(group, names(summstats))]]
group_summstats
group_summstats
group_summstats$species
group_summstats$species <- sub(" ","_", group_summstats$species)
group_summstats
group_summstats$species
group_summstats
grep("species", colnames(species))
grep("species", colnames(group_summstats))
colnames(group_traits)
merged_table <- merge(group_summstats, group_traits, by.x="species", by.y="Species")
merged_table
merged_table
colnames(merged_table)
cleaned_table <- merged_table[,c("mean_bio1","mean_bio12","Dispersal_mode")]
cleaned_table
cleaned_table$mean_bio1=="not_enough_points"
cleaned_table <- merged_table[-which(cleaned_table$mean_bio1=="not_enough_points"),c("mean_bio1","mean_bio12","Dispersal_mode")]
cleaned_table
cleaned_table_biotic <- cleaned_table[which(cleaned_table$Dispersal_mode=="Biotic"),]
cleaned_table_abiotic <- cleaned_table[which(cleaned_table$Dispersal_mode=="Abiotic"),]
cleaned_table_biotic
cleaned_table_abiotic
cleaned_table_biotic <- cleaned_table[which(cleaned_table$Dispersal_mode=="Biotic"),-3]
cleaned_table_abiotic <- cleaned_table[which(cleaned_table$Dispersal_mode=="Abiotic"),-3]
cleaned_table_biotic
cleaned_table_abiotic
## Use densCols() output to get density at each point
cleaned_table_biotic <- densCols(mean_bio1, mean_bio12, colramp=colorRampPalette(c("black", "white")))
## Use densCols() output to get density at each point
cleaned_table_biotic <- densCols(x1, x2, colramp=colorRampPalette(c("black", "white")))
cleaned_table_biotic
cleaned_table_biotic <- cleaned_table[which(cleaned_table$Dispersal_mode=="Biotic"),-3]
cleaned_table_abiotic <- cleaned_table[which(cleaned_table$Dispersal_mode=="Abiotic"),-3]
## Use densCols() output to get density at each point
x <- densCols(x1, x2, colramp=colorRampPalette(c("black", "white")))
cleaned_table_biotic$dens <- col2rgb(x)[1,] + 1L
## Use densCols() output to get density at each point
x <- densCols(cleaned_table_biotic$mean_bio1, cleaned_table_biotic$mean_bio12, colramp=colorRampPalette(c("black", "white")))
cleaned_table_biotic$dens <- col2rgb(x)[1,] + 1L
## Map densities to colors
cols <-  colorRampPalette(c("#000099", "#00FEFF", "#45FE4F",
"#FCFF00", "#FF9400", "#FF3100"))(256)
cleaned_table_biotic$col <- cols[cleaned_table_biotic$dens]
## Plot it, reordering rows so that densest points are plotted on top
plot(mean_bio1~mean_bio12, data=cleaned_table_biotic[order(cleaned_table_biotic$dens),], pch=20, col=col, cex=2)
x <- densCols(cleaned_table_abiotic$mean_bio1, cleaned_table_abiotic$mean_bio12, colramp=colorRampPalette(c("black", "white")))
cleaned_table_abiotic$dens <- col2rgb(x)[1,] + 1L
cols <-  colorRampPalette(c("#000099", "#00FEFF", "#45FE4F",
"#FCFF00", "#FF9400", "#FF3100"))(256)
cleaned_table_abiotic$col <- cols[cleaned_table_abiotic$dens]
plot(mean_bio1~mean_bio12, data=cleaned_table_abiotic[order(cleaned_table_abiotic$dens),], pch=20, col=col, cex=2)
colramp = colorRampPalette(c('white', 'blue', 'green', 'yellow', 'red'))
smoothScatter(x1, x2, colramp=colramp)
plot(mean_bio1~mean_bio12, data=cleaned_table_abiotic[order(cleaned_table_abiotic$dens),], pch=20, col=col, cex=2)
?densCols
cleaned_table_abiotic$col <- cols[cleaned_table_abiotic$dens]
plot(mean_bio1~mean_bio12, data=cleaned_table_abiotic[order(cleaned_table_abiotic$dens),], pch=20, col=col, cex=2)
plot(mean_bio1~rev(mean_bio12), data=cleaned_table_abiotic[order(cleaned_table_abiotic$dens),], pch=20, col=col, cex=2)
x <- densCols(cleaned_table_biotic$mean_bio1, cleaned_table_biotic$mean_bio12, colramp=colorRampPalette(c("black", "white")))
cleaned_table_biotic$dens <- col2rgb(x)[1,] + 1L
cols <-  colorRampPalette(c("#000099", "#00FEFF", "#45FE4F",
"#FCFF00", "#FF9400", "#FF3100"))(256)
cleaned_table_biotic$col <- cols[cleaned_table_biotic$dens]
plot(mean_bio12~mean_bio1, data=cleaned_table_biotic[order(cleaned_table_biotic$dens),], pch=20, col=col, cex=2)
x <- densCols(cleaned_table_abiotic$mean_bio1, cleaned_table_abiotic$mean_bio12, colramp=colorRampPalette(c("black", "white")))
cleaned_table_abiotic$dens <- col2rgb(x)[1,] + 1L
cols <-  colorRampPalette(c("#000099", "#00FEFF", "#45FE4F",
"#FCFF00", "#FF9400", "#FF3100"))(256)
cleaned_table_abiotic$col <- cols[cleaned_table_abiotic$dens]
plot(mean_bio12~mean_bio1, data=cleaned_table_abiotic[order(cleaned_table_abiotic$dens),], pch=20, col=col, cex=2)
plot(mean_bio12~mean_bio1, data=cleaned_table_abiotic[order(cleaned_table_abiotic$dens),], pch=20, col=col, cex=2, ylim=c(0,4000))
plot(mean_bio12~mean_bio1, data=cleaned_table_abiotic[order(cleaned_table_abiotic$dens),], pch=20, col=col, cex=2, ylim=c(0,4000), xlim=c(-100,300))
plot(mean_bio12~mean_bio1, data=cleaned_table_biotic[order(cleaned_table_biotic$dens),], pch=20, col=col, cex=2, ylim=c(0,4000), xlim=c(-100,300))
par(mfrow=c(1,2))
x <- densCols(cleaned_table_biotic$mean_bio1, cleaned_table_biotic$mean_bio12, colramp=colorRampPalette(c("black", "white")))
cleaned_table_biotic$dens <- col2rgb(x)[1,] + 1L
cols <-  colorRampPalette(c("#000099", "#00FEFF", "#45FE4F",
"#FCFF00", "#FF9400", "#FF3100"))(256)
cleaned_table_biotic$col <- cols[cleaned_table_biotic$dens]
plot(mean_bio12~mean_bio1, data=cleaned_table_biotic[order(cleaned_table_biotic$dens),], pch=20, col=col, cex=2, ylim=c(0,4000), xlim=c(-100,300))
group
plot(mean_bio12~mean_bio1, data=cleaned_table_abiotic[order(cleaned_table_abiotic$dens),], pch=20, col=col, cex=2, ylim=c(0,4000), xlim=c(-100,300))
title("abiotic")
for(group_index in 1:length(labels)) {
group <- names(traits)[group_index]
group_traits <- traits[[group]][,1:2]
group_summstats <- summstats[[grep(group, names(summstats))]]
group_summstats$species <- sub(" ","_", group_summstats$species)
merged_table <- merge(group_summstats, group_traits, by.x="species", by.y="Species")
cleaned_table <- merged_table[-which(cleaned_table$mean_bio1=="not_enough_points"),c("mean_bio1","mean_bio12","Dispersal_mode")]
cleaned_table_biotic <- cleaned_table[which(cleaned_table$Dispersal_mode=="Biotic"),-3]
cleaned_table_abiotic <- cleaned_table[which(cleaned_table$Dispersal_mode=="Abiotic"),-3]
pdf(paste0(getwd(), "/", group, ".pdf"))
par(mfrow=c(1,2))
x <- densCols(cleaned_table_biotic$mean_bio1, cleaned_table_biotic$mean_bio12, colramp=colorRampPalette(c("black", "white")))
cleaned_table_biotic$dens <- col2rgb(x)[1,] + 1L
cols <-  colorRampPalette(c("#000099", "#00FEFF", "#45FE4F",
"#FCFF00", "#FF9400", "#FF3100"))(256)
cleaned_table_biotic$col <- cols[cleaned_table_biotic$dens]
plot(mean_bio12~mean_bio1, data=cleaned_table_biotic[order(cleaned_table_biotic$dens),], pch=20, col=col, cex=2, ylim=c(0,4000), xlim=c(-100,300))
title("biotic")
x <- densCols(cleaned_table_abiotic$mean_bio1, cleaned_table_abiotic$mean_bio12, colramp=colorRampPalette(c("black", "white")))
cleaned_table_abiotic$dens <- col2rgb(x)[1,] + 1L
cols <-  colorRampPalette(c("#000099", "#00FEFF", "#45FE4F",
"#FCFF00", "#FF9400", "#FF3100"))(256)
cleaned_table_abiotic$col <- cols[cleaned_table_abiotic$dens]
plot(mean_bio12~mean_bio1, data=cleaned_table_abiotic[order(cleaned_table_abiotic$dens),], pch=20, col=col, cex=2, ylim=c(0,4000), xlim=c(-100,300))
title("abiotic")
dev.off()
}
group_index
group <- names(traits)[group_index]
group_traits <- traits[[group]][,1:2]
group_summstats <- summstats[[grep(group, names(summstats))]]
group_summstats$species <- sub(" ","_", group_summstats$species)
merged_table <- merge(group_summstats, group_traits, by.x="species", by.y="Species")
cleaned_table <- merged_table[-which(cleaned_table$mean_bio1=="not_enough_points"),c("mean_bio1","mean_bio12","Dispersal_mode")]
cleaned_table_biotic <- cleaned_table[which(cleaned_table$Dispersal_mode=="Biotic"),-3]
cleaned_table_abiotic <- cleaned_table[which(cleaned_table$Dispersal_mode=="Abiotic"),-3]
pdf(paste0(getwd(), "/", group, ".pdf"))
par(mfrow=c(1,2))
x <- densCols(cleaned_table_biotic$mean_bio1, cleaned_table_biotic$mean_bio12, colramp=colorRampPalette(c("black", "white")))
x
x <- densCols(cleaned_table_biotic$mean_bio1, cleaned_table_biotic$mean_bio12, colramp=colorRampPalette(c("black", "white")))
cleaned_table_biotic$mean_bio1
group <- names(traits)[group_index]
group_traits <- traits[[group]][,1:2]
group_summstats <- summstats[[grep(group, names(summstats))]]
group_summstats$species <- sub(" ","_", group_summstats$species)
group_summstats
merged_table <- merge(group_summstats, group_traits, by.x="species", by.y="Species")
merged_table
cleaned_table <- merged_table[-which(cleaned_table$mean_bio1=="not_enough_points"),c("mean_bio1","mean_bio12","Dispersal_mode")]
cleaned_table
merged_table
which(merged_table$mean_bio1=="not_enough_points")
cleaned_table <- merged_table[-which(merged_table$mean_bio1=="not_enough_points"),c("mean_bio1","mean_bio12","Dispersal_mode")]
cleaned_table
for(group_index in 1:length(labels)) {
group <- names(traits)[group_index]
group_traits <- traits[[group]][,1:2]
group_summstats <- summstats[[grep(group, names(summstats))]]
group_summstats$species <- sub(" ","_", group_summstats$species)
merged_table <- merge(group_summstats, group_traits, by.x="species", by.y="Species")
cleaned_table <- merged_table[-which(merged_table$mean_bio1=="not_enough_points"),c("mean_bio1","mean_bio12","Dispersal_mode")]
cleaned_table_biotic <- cleaned_table[which(cleaned_table$Dispersal_mode=="Biotic"),-3]
cleaned_table_abiotic <- cleaned_table[which(cleaned_table$Dispersal_mode=="Abiotic"),-3]
pdf(paste0(getwd(), "/", group, ".pdf"))
par(mfrow=c(1,2))
x <- densCols(cleaned_table_biotic$mean_bio1, cleaned_table_biotic$mean_bio12, colramp=colorRampPalette(c("black", "white")))
cleaned_table_biotic$dens <- col2rgb(x)[1,] + 1L
cols <-  colorRampPalette(c("#000099", "#00FEFF", "#45FE4F",
"#FCFF00", "#FF9400", "#FF3100"))(256)
cleaned_table_biotic$col <- cols[cleaned_table_biotic$dens]
plot(mean_bio12~mean_bio1, data=cleaned_table_biotic[order(cleaned_table_biotic$dens),], pch=20, col=col, cex=2, ylim=c(0,4000), xlim=c(-100,300))
title("biotic")
x <- densCols(cleaned_table_abiotic$mean_bio1, cleaned_table_abiotic$mean_bio12, colramp=colorRampPalette(c("black", "white")))
cleaned_table_abiotic$dens <- col2rgb(x)[1,] + 1L
cols <-  colorRampPalette(c("#000099", "#00FEFF", "#45FE4F",
"#FCFF00", "#FF9400", "#FF3100"))(256)
cleaned_table_abiotic$col <- cols[cleaned_table_abiotic$dens]
plot(mean_bio12~mean_bio1, data=cleaned_table_abiotic[order(cleaned_table_abiotic$dens),], pch=20, col=col, cex=2, ylim=c(0,4000), xlim=c(-100,300))
title("abiotic")
dev.off()
}
group_index
for(group_index in 1:length(labels)) {
group <- names(traits)[group_index]
group_traits <- traits[[group]][,1:2]
group_summstats <- summstats[[grep(group, names(summstats))]]
group_summstats$species <- sub(" ","_", group_summstats$species)
merged_table <- merge(group_summstats, group_traits, by.x="species", by.y="Species")
cleaned_table <- merged_table[-which(merged_table$mean_bio1=="not_enough_points"),c("mean_bio1","mean_bio12","Dispersal_mode")]
cleaned_table_biotic <- cleaned_table[which(cleaned_table$Dispersal_mode=="Biotic"),-3]
cleaned_table_abiotic <- cleaned_table[which(cleaned_table$Dispersal_mode=="Abiotic"),-3]
pdf(paste0(getwd(), "/", group, ".pdf"), height=4, width=8)
par(mfrow=c(1,2))
x <- densCols(cleaned_table_biotic$mean_bio1, cleaned_table_biotic$mean_bio12, colramp=colorRampPalette(c("black", "white")))
cleaned_table_biotic$dens <- col2rgb(x)[1,] + 1L
cols <-  colorRampPalette(c("#000099", "#00FEFF", "#45FE4F",
"#FCFF00", "#FF9400", "#FF3100"))(256)
cleaned_table_biotic$col <- cols[cleaned_table_biotic$dens]
plot(mean_bio12~mean_bio1, data=cleaned_table_biotic[order(cleaned_table_biotic$dens),], pch=20, col=col, cex=2, ylim=c(0,4000), xlim=c(-100,300))
title("biotic")
x <- densCols(cleaned_table_abiotic$mean_bio1, cleaned_table_abiotic$mean_bio12, colramp=colorRampPalette(c("black", "white")))
cleaned_table_abiotic$dens <- col2rgb(x)[1,] + 1L
cols <-  colorRampPalette(c("#000099", "#00FEFF", "#45FE4F",
"#FCFF00", "#FF9400", "#FF3100"))(256)
cleaned_table_abiotic$col <- cols[cleaned_table_abiotic$dens]
plot(mean_bio12~mean_bio1, data=cleaned_table_abiotic[order(cleaned_table_abiotic$dens),], pch=20, col=col, cex=2, ylim=c(0,4000), xlim=c(-100,300))
title("abiotic")
dev.off()
}
cleaned_table_abiotic
pca(cleaned_table_abiotic$mean_bio1, cleaned_table_abiotic$mean_bio12)
?pca
??pca
prcomp(cleaned_table_abiotic$mean_bio1, cleaned_table_abiotic$mean_bio12)
cleaned_table_abiotic[,1:2]
prcomp(cleaned_table_abiotic[,1:2])
